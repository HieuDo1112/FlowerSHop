<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Flower Shop</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

    <link rel="stylesheet" href="./ProductStyle.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
      integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet" />

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </head>
  <body>
    <!-- Header -->
    <header>
      <nav class="navbar navbar-expand-lg">
        <div class="container d-flex border-cus">
          <div class="navbar-brand">
            <img src="./image/Logo.png" alt="FlowerShop Logo" height="50" />
          </div>

          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav mx-auto gap-5 nav-link">
              <li class="nav-item">
                <a class="nav-link" href="Home.html">Trang ch·ªß</a>
              </li>
              <li class="nav-item">
                <a class="nav-link active" href="Product.html">S·∫£n ph·∫©m</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="About.html">Gi·ªõi thi·ªáu</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="Contact.html">Li√™n h·ªá</a>
              </li>
            </ul>

            <div class="d-flex">
              <button class="btn me-2 btn-cus">
                <i class="fas fa-search"></i>
              </button>

              <a href="Cart.html" class="btn btn-cus">
                <i class="fas fa-shopping-cart"></i>
              </a>
              <a class="btn btn-cus ms-2">ƒêƒÉng nh·∫≠p</a>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <!-- Danh s√°ch t·∫•t c·∫£ s·∫£n ph·∫©m-->
    <section class="list-products">
      <div class="category-header">
        <h1 class="category-title">
          <span class="category-title-black">Danh M·ª•c </span>
          <span class="category-title-pink">S·∫£n Ph·∫©m</span>
        </h1>
      </div>
      <div class="categories">
        <button class="category-btn active" data-category="1">B√≥ hoa</button>
        <button class="category-btn" data-category="2">Gi·ªè hoa</button>
        <button class="category-btn" data-category="3">Hoa sinh nh·∫≠t</button>
        <button class="category-btn" data-category="4">B√¨nh hoa</button>
        <button class="category-btn" data-category="5">Gi·∫£m gi√°</button>
      </div>
      <div class="product-list"></div>

      <div class="pagination"></div>
    </section>

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-container">
        <div class="footer-logo">
          <img src="image/Logo.png" alt="NA Flower Logo" />
          <div class="social-icons">
            <a href="#" class="social-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2">
                <path
                  d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>
              </svg>
            </a>
            <a href="#" class="social-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2">
                <path
                  d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
              </svg>
            </a>
            <a href="#" class="social-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2">
                <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
                <path
                  d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
                <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line>
              </svg>
            </a>
            <a href="#" class="social-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2">
                <path
                  d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path>
                <rect x="2" y="9" width="4" height="12"></rect>
                <circle cx="4" cy="4" r="2"></circle>
              </svg>
            </a>
          </div>
        </div>

        <div class="footer-info">
          <h3 class="footer-title">V·ªÅ ch√∫ng t√¥i:</h3>
          <ul class="footer-links">
            <li><a href="Contact.html">Li√™n h·ªá NA Flower Store</a></li>
            <li><a href="#">Ch√≠nh s√°ch v√† ƒëi·ªÅu kho·∫£n s·ª≠ d·ª•ng</a></li>
          </ul>
        </div>

        <div class="footer-contact">
          <h3 class="footer-title">ƒê·ªãa ch·ªâ c·ªßa ch√∫ng t√¥i:</h3>
          <div class="footer-contact-item">
            <i>üìç</i> T·∫ßng 16 - T√≤a nh√† U-silk 01
          </div>
          <div class="footer-contact-item">
            <i>‚úâÔ∏è</i> cskhNAflower@gmail.com
          </div>
          <div class="footer-contact-item"><i>üìû</i> 0123456789</div>
        </div>
      </div>

      <!-- Footer -->
      <div class="container">
        <div class="copyright">¬© 2025 - B·∫£n quy·ªÅn thu·ªôc v·ªÅ Ng·ªçc √Ånh</div>
      </div>
    </footer>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const productList = document.querySelector(".product-list");
        const categoryButtons = document.querySelectorAll(".category-btn");
        const paginationContainer = document.querySelector(".pagination");

        let currentCategory = 1; // M·∫∑c ƒë·ªãnh danh m·ª•c ƒë·∫ßu ti√™n
        let currentPage = 1; // Trang m·∫∑c ƒë·ªãnh
        const itemsPerPage = 6; // M·ªói trang hi·ªÉn th·ªã 6 s·∫£n ph·∫©m
        let allProducts = []; // L∆∞u to√†n b·ªô s·∫£n ph·∫©m c·ªßa category hi·ªán t·∫°i

        fetchProducts(currentCategory); // Load danh m·ª•c m·∫∑c ƒë·ªãnh

        // X·ª≠ l√Ω s·ª± ki·ªán khi ch·ªçn danh m·ª•c
        categoryButtons.forEach((button) => {
          button.addEventListener("click", function () {
            categoryButtons.forEach((btn) => btn.classList.remove("active"));
            this.classList.add("active");

            currentCategory = this.getAttribute("data-category");
            currentPage = 1; // Reset v·ªÅ trang 1 khi ƒë·ªïi danh m·ª•c
            fetchProducts(currentCategory);
          });
        });

        // H√†m fetch API l·∫•y to√†n b·ªô s·∫£n ph·∫©m c·ªßa categoryId
        function fetchProducts(categoryId) {
          fetch("https://localhost:7206/api/Products")
            .then((response) => response.json())
            .then((data) => {
              // L·ªçc s·∫£n ph·∫©m theo categoryId
              allProducts = data.filter(
                (product) => product.categoryId == categoryId
              );
              renderProducts();
              renderPagination();
            })
            .catch((error) => console.error("L·ªói khi fetch API:", error));
        }

        // H√†m render danh s√°ch s·∫£n ph·∫©m theo trang (updated)
        function renderProducts() {
          const startIndex = (currentPage - 1) * itemsPerPage;
          const endIndex = startIndex + itemsPerPage;
          const visibleProducts = allProducts.slice(startIndex, endIndex);

          productList.innerHTML = visibleProducts
            .map(
              (product) => `
      <div class="product" data-id="${product.id}">
        <img src="https://localhost:7206${product.image}" alt="${
                product.name
              }" />
        <h3>${product.name}</h3>
        <p class="price">${product.price.toLocaleString("vi-VN")}ƒë</p>
        <div class="product-actions">
          <a href="Cart.html" class="add-to-cart" data-id="${
            product.id
          }">Th√™m v√†o gi·ªè h√†ng</a>
          
        </div>
      </div>
    `
            )
            .join("");

          // Th√™m s·ª± ki·ªán click v√†o s·∫£n ph·∫©m
          addProductClickEvents();
        }

        // H√†m th√™m s·ª± ki·ªán click v√†o s·∫£n ph·∫©m
        function addProductClickEvents() {
          document.querySelectorAll(".product").forEach((product) => {
            product.addEventListener("click", function (e) {
              // Ch·ªâ x·ª≠ l√Ω n·∫øu click kh√¥ng ph·∫£i v√†o n√∫t action( except action)
              if (!e.target.closest(".product-actions")) {
                const productId = this.dataset.id;
                window.location.href = `Detail.html?id=${productId}`;
              }
            });
          });
        }

        // H√†m render pagination
        function renderPagination() {
          const totalPages = Math.ceil(allProducts.length / itemsPerPage);
          paginationContainer.innerHTML = "";

          if (totalPages <= 1) return;

          if (currentPage > 1) {
            paginationContainer.innerHTML += `<a href="#" class="page-link prev">‚Üê</a>`;
          }

          for (let i = 1; i <= totalPages; i++) {
            const isCurrent = i === currentPage;
            paginationContainer.innerHTML += `
        <a href="#" class="page-link ${
          isCurrent ? "current" : ""
        }" data-page="${i}">
          ${i}
        </a>
      `;
          }

          if (currentPage < totalPages) {
            paginationContainer.innerHTML += `<a href="#" class="page-link next">‚Üí</a>`;
          }

          addPaginationEventListeners();
        }

        // H√†m x·ª≠ l√Ω s·ª± ki·ªán chuy·ªÉn trang
        function addPaginationEventListeners() {
          paginationContainer.querySelectorAll(".page-link").forEach((link) => {
            link.addEventListener("click", (e) => {
              e.preventDefault();
              if (link.classList.contains("prev")) {
                currentPage--;
              } else if (link.classList.contains("next")) {
                currentPage++;
              } else {
                currentPage = parseInt(link.getAttribute("data-page"));
              }
              renderProducts();
              renderPagination();
            });
          });
        }
      });
    </script>
  </body>
</html>
