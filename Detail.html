<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Flower Shop</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

    <link rel="stylesheet" href="./DetailStyle.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
      integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet" />

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </head>
  <body>
    <!-- Header -->
    <header>
      <nav class="navbar navbar-expand-lg">
        <div class="container d-flex border-cus">
          <div class="navbar-brand">
            <img src="./image/Logo.png" alt="FlowerShop Logo" height="50" />
          </div>

          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav mx-auto gap-5 nav-link">
              <li class="nav-item">
                <a class="nav-link" href="Home.html">Trang ch·ªß</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="Product.html">S·∫£n ph·∫©m</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="About.html">Gi·ªõi thi·ªáu</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="Contact.html">Li√™n h·ªá</a>
              </li>
            </ul>

            <div class="d-flex">
              <button class="btn me-2 btn-cus">
                <i class="fas fa-search"></i>
              </button>

              <a href="Cart.html" class="btn btn-cus">
                <i class="fas fa-shopping-cart"></i>
              </a>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container">
      <!-- Breadcrumb -->
      <ul class="breadcrumb">
        <!-- <li><a href="Home.html">Trang ch·ªß</a></li>
        <li><a href="Product.html">S·∫£n ph·∫©m</a></li>
        <li>B√≥ hoa t√¨nh y√™u</li> -->
      </ul>

      <!-- Product Detail -->
      <div class="product-detail">
        <!-- Product Gallery -->
        <div class="product-gallery">
          <!-- <img
            src="image/detail1.png"
            alt="B√≥ hoa t√¨nh y√™u"
            class="main-image" />
          <div class="thumbnail-container">
            <img
              src="image/product6.png"
              alt="Thumbnail 1"
              class="thumbnail active" />
          </div> -->
        </div>

        <!-- Product Info -->
        <div class="product-info">
          <h1 class="product-title"></h1>
          <div class="product-price"></div>
          <div class="product-short-description">
            <p>
              <!-- B√≥ hoa T√¨nh Y√™u t·ª´ AN Flower Store l√† s·ª± k·∫øt h·ª£p t√¨nh t·∫ø gi·ªØa
              nh·ªØng b√¥ng h·ªìng ƒë·ªè r·ª±c r·ª° ‚Äì bi·ªÉu t∆∞·ª£ng c·ªßa t√¨nh y√™u m√£nh li·ªát,
              c√πng nh·ªØng b√¥ng h·ªìa tr·∫Øng tinh kh√¥i v√† v·∫ª ƒë·∫πp thu·∫ßn khi·∫øt c·ªßa
              nh√°nh l√° xanh. M·ªói c√†nh hoa ƒë·ªÅu ƒë∆∞·ª£c ch·ªçn l·ªçc k·ªπ l∆∞·ª°ng, mang ƒë·∫øn
              th√¥ng ƒëi·ªáp y√™u th∆∞∆°ng chan ch·ª©a nh·∫•t. -->
            </p>
          </div>
          <button class="add-to-cart">Th√™m v√†o gi·ªè h√†ng</button>
          <div class="delivery-info">
            <p>
              <i>‚úì</i> ƒê·∫£m b·∫£o 100% hoa t∆∞∆°i - Ho√†n ti·ªÅn g·∫•p ƒë√¥i n·∫øu hoa b·ªã d·∫≠p
              n√°t, kh√¥ h√©o
            </p>
            <p>
              <i>‚úì</i> T·∫≠n h∆∞·ªüng d·ªãch v·ª• thanh to√°n t·∫≠n nh√† - Thanh to√°n t·∫°i nh√†
            </p>
            <p><i>‚úì</i> Tr·∫£ hoa v√† ƒë·ªïi hoa d·ªÖ d√†ng trong 1 gi·ªù</p>
          </div>
        </div>
      </div>

      <!-- Descriptions Section -->
      <div class="descriptions-section">
        <h2 class="descriptions-title">M√¥ t·∫£</h2>

        <div class="description">
          <div class="description-header">
            <div class="description-author">
              <!-- B√≥ Hoa T√¨nh Y√™u - ƒê·ªën Tim Y√™u Th∆∞∆°ng ‚ù§Ô∏è -->
            </div>
          </div>
          <div class="description-content">
            <p>
              <!-- B√≥ Hoa T√¨nh Y√™u t·ª´ NA Flower Store l√† s·ª± k·∫øt h·ª£p tinh t·∫ø gi·ªØa
              nh·ªØng b√¥ng h·ªìng ƒë·ªè r·ª±c r·ª° ‚Äì bi·ªÉu t∆∞·ª£ng c·ªßa t√¨nh y√™u m√£nh li·ªát,
              c√πng nh·ªØng b√¥ng hoa tr·∫Øng tinh kh√¥i v√† v·∫ªn c·∫°n. M·ªói c√†nh hoa ƒë·ªÅu
              ƒë∆∞·ª£c ch·ªçn l·ªçc k·ªπ l∆∞·ª°ng, mang ƒë·∫øn th√¥ng ƒëi·ªáp y√™u th∆∞∆°ng chan ch·ª©a
              nh·∫•t. -->
            </p>
          </div>
        </div>

        <div class="description">
          <div class="description-header">
            <div class="description-author">
              ‚ù§Ô∏è NA Flower Store - g·ª≠i g·∫Øm nh·ªØng c·∫£m x√∫c ch√¢n th√†nh! ‚ù§Ô∏è
            </div>
          </div>
          <div class="description-content">
            <p>
              D√†nh t·∫∑ng ng∆∞·ªùi y√™u, v√† h·ªç s·∫Ω m·ªâm c∆∞·ªùi ƒë·∫∑c bi·ªát c·ªßa b·∫°n trong
              nh·ªØng d·ªãp ƒë·∫∑c bi·ªát nh∆∞, ng√†y Valentine, sinh nh·∫≠t, ho·∫∑c ƒë∆°n gi·∫£n
              ch·ªâ l√† n√≥i l·ªùi y√™u th∆∞∆°ng! ‚ù§Ô∏è
            </p>
          </div>
        </div>
      </div>

      <!-- Related Products -->
      <div class="related-products">
        <div class="category-header">
          <h1 class="category-title">
            <span class="category-title-black">S·∫£n ph·∫©m </span>
            <span class="category-title-pink">Li√™n Quan</span>
          </h1>
        </div>

        <div class="products-grid">
          <a href="#" class="product-card">
            <img
              src="https://placehold.co/300x200"
              alt="B√≥ hoa Tulip"
              class="product-card-image" />
            <div class="product-card-info">
              <h3 class="product-card-title">B√≥ hoa Tulip</h3>
              <div class="product-card-price">200.000ƒë</div>
            </div>
          </a>
        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-container">
        <div class="footer-logo">
          <img src="image/Logo.png" alt="NA Flower Logo" />
          <div class="social-icons">
            <a href="#" class="social-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2">
                <path
                  d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>
              </svg>
            </a>
            <a href="#" class="social-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2">
                <path
                  d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
              </svg>
            </a>
            <a href="#" class="social-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2">
                <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
                <path
                  d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
                <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line>
              </svg>
            </a>
            <a href="#" class="social-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2">
                <path
                  d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path>
                <rect x="2" y="9" width="4" height="12"></rect>
                <circle cx="4" cy="4" r="2"></circle>
              </svg>
            </a>
          </div>
        </div>

        <div class="footer-info">
          <h3 class="footer-title">V·ªÅ ch√∫ng t√¥i:</h3>
          <ul class="footer-links">
            <li><a href="Contact.html">Li√™n h·ªá NA Flower Store</a></li>
            <li><a href="Policy.html">Ch√≠nh s√°ch v√† ƒëi·ªÅu kho·∫£n s·ª≠ d·ª•ng</a></li>
          </ul>
        </div>

        <div class="footer-contact">
          <h3 class="footer-title">ƒê·ªãa ch·ªâ c·ªßa ch√∫ng t√¥i:</h3>
          <div class="footer-contact-item">
            <i>üìç</i> T·∫ßng 16 - T√≤a nh√† U-silk 01
          </div>
          <div class="footer-contact-item">
            <i>‚úâÔ∏è</i> cskhNAflower@gmail.com
          </div>
          <div class="footer-contact-item"><i>üìû</i> 0123456789</div>
        </div>
      </div>

      <!-- Footer -->
      <div class="container">
        <div class="copyright">¬© 2025 - B·∫£n quy·ªÅn thu·ªôc v·ªÅ Ng·ªçc √Ånh</div>
      </div>
    </footer>

    <script>
      document.addEventListener("DOMContentLoaded", async () => {
        // L·∫•y productId t·ª´ URL
        const urlParams = new URLSearchParams(window.location.search);
        const productId = urlParams.get("id");

        if (!productId) {
          window.location.href = "404.html";
          return;
        }

        try {
          // Fetch chi ti·∫øt s·∫£n ph·∫©m
          const response = await fetch(
            `https://localhost:7206/api/Products/${productId}`
          );
          if (!response.ok) throw new Error("Product not found");

          const product = await response.json();

          // C·∫≠p nh·∫≠t breadcrumb
          updateBreadcrumb(product);

          // C·∫≠p nh·∫≠t gallery ·∫£nh
          updateProductGallery(product);

          // C·∫≠p nh·∫≠t th√¥ng tin s·∫£n ph·∫©m
          updateProductInfo(product);

          // Load s·∫£n ph·∫©m li√™n quan
          await fetchRelatedProducts(product.categoryId, product.id);
        } catch (error) {
          console.error("Error:", error);
          window.location.href = "404.html";
        }
      });

      // H√†m c·∫≠p nh·∫≠t breadcrumb
      function updateBreadcrumb(product) {
        const breadcrumb = document.querySelector(".breadcrumb");
        breadcrumb.innerHTML = `
    <li><a href="Home.html">Trang ch·ªß</a></li>
    <li><a href="Product.html">S·∫£n ph·∫©m</a></li>
    <li>${product.name}</li>
  `;
      }

      // H√†m c·∫≠p nh·∫≠t gallery ·∫£nh
      function updateProductGallery(product) {
        const gallery = document.querySelector(".product-gallery");
        gallery.innerHTML = `
    <img src="https://localhost:7206${product.image}" 
         alt="${product.name}" 
         class="main-image" />
    <div class="thumbnail-container">
      <img src="https://localhost:7206${product.image}" 
           alt="Thumbnail" 
           class="thumbnail active" />
      <!-- C√≥ th·ªÉ th√™m nhi·ªÅu thumbnail kh√°c n·∫øu c√≥ -->
    </div>
  `;
      }

      // H√†m c·∫≠p nh·∫≠t th√¥ng tin s·∫£n ph·∫©m
      function updateProductInfo(product) {
        document.querySelector(".product-title").textContent = product.name;
        document.querySelector(
          ".product-price"
        ).textContent = `${product.price.toLocaleString("vi-VN")}ƒë`;

        const shortDesc = document.querySelector(
          ".product-short-description p"
        );
        shortDesc.textContent = product.shortDescription;

        // Th√™m m√¥ t·∫£ ƒë·∫ßy ƒë·ªß n·∫øu c√≥ ph·∫ßn ƒë√≥ trong HTML
        const fullDesc = document.querySelector(".product-full-description");
        if (fullDesc) {
          fullDesc.innerHTML = `<p>${product.description}</p>`;
        }

        // C·∫≠p nh·∫≠t c√°c th√¥ng tin kh√°c li√™n quan
        const categoryInfo = document.querySelector(".product-category");
        if (categoryInfo) {
          categoryInfo.textContent = `Danh m·ª•c: ${product.category.name}`;
        }

        const descriptionAuthor = document.querySelector(".description-author");
        const descriptionContent = document.querySelector(
          ".description-content p"
        );

        if (descriptionAuthor) {
          descriptionAuthor.textContent = `‚ù§Ô∏è ${product.name} ‚ù§Ô∏è`;
        }

        if (descriptionContent) {
          descriptionContent.textContent = product.description;
        }
      }

      // H√†m fetch s·∫£n ph·∫©m li√™n quan
      async function fetchRelatedProducts(categoryId, currentProductId) {
        try {
          const response = await fetch(
            `https://localhost:7206/api/Products?categoryId=${categoryId}`
          );
          const products = await response.json();

          // L·ªçc b·ªè s·∫£n ph·∫©m hi·ªán t·∫°i v√† l·∫•y t·ªëi ƒëa 4 s·∫£n ph·∫©m
          const relatedProducts = products
            .filter((p) => p.id != currentProductId)
            .slice(0, 4);

          renderRelatedProducts(relatedProducts);
        } catch (error) {
          console.error("L·ªói khi l·∫•y s·∫£n ph·∫©m li√™n quan:", error);
          document.querySelector(".products-grid").innerHTML =
            '<p class="no-products">Hi·ªán ch∆∞a c√≥ s·∫£n ph·∫©m li√™n quan</p>';
        }
      }

      // H√†m render s·∫£n ph·∫©m li√™n quan
      function renderRelatedProducts(products) {
        const productsGrid = document.querySelector(".products-grid");
        if (!productsGrid) return;

        if (products.length === 0) {
          productsGrid.innerHTML =
            '<p class="no-products">Hi·ªán ch∆∞a c√≥ s·∫£n ph·∫©m li√™n quan</p>';
          return;
        }

        productsGrid.innerHTML = products
          .map(
            (product) => `
    <a href="Detail.html?id=${product.id}" class="product-card">
      <img src="https://localhost:7206${product.image}" 
           alt="${product.name}" 
           class="product-card-image" />
      <div class="product-card-info">
        <h3 class="product-card-title">${product.name}</h3>
        <div class="product-card-price">${product.price.toLocaleString(
          "vi-VN"
        )}ƒë</div>
      </div>
    </a>
  `
          )
          .join("");
      }
    </script>
  </body>
</html>
